@include(top.htm)

<div id="headline">Nowhere Lost and Found Logbook</div>

<div id="contentcontainer">Getting the list of all items from the server...</div>

<script>

	var request = new XMLHttpRequest();
	request.open("POST", "/items", false);
	request.setRequestHeader("Content-Type", "application/json");

	// TODO :: add different categories of things (and show overviews over just items of that category)
	request.onreadystatechange = function() {
		if (request.readyState == 4 && request.status == 200) {

			var data = JSON.parse(request.responseText);
			var lostItems = data.lostItems;
			var foundItems = data.foundItems;
			var out = "";

			for (var i = 0; i < lostItems.length; i++) {
				var item = lostItems[i];
				out += "<div id='item_" + item.id + "'>";
					out += "<h3>Item #" + item.id + " (Lost)</h3>";
					out += "<div>What: " + item.what.split("\n").join("<br>") + "</div>";
					out += "<div>When: " + item.when.split("\n").join("<br>") + "</div>";
					out += "<div>Where: " + item.where.split("\n").join("<br>") + "</div>";
					out += "<div>Who: " + item.who.split("\n").join("<br>") + "</div>";
					out += "<div>On-site Contact: " + item.contactonsite.split("\n").join("<br>") + "</div>";
					out += "<div>Off-site Contact: " + item.contactoffsite.split("\n").join("<br>") + "</div>";
				out += "</div>";
			}

			for (var i = 0; i < foundItems.length; i++) {
				var item = foundItems[i];
				out += "<div id='item_" + item.id + "'>";
					out += "<h3>Item #" + item.id + " (Found)</h3>";
					out += "<div>What: " + item.what.split("\n").join("<br>") + "</div>";
					if (item.picture) {
						out += "<img src=\"/" + item.picture + "\" />";
					}
					out += "<div>When: " + item.when.split("\n").join("<br>") + "</div>";
					out += "<div>Where: " + item.where.split("\n").join("<br>") + "</div>";
					out += "<div>Who: " + item.who.split("\n").join("<br>") + "</div>";
				out += "</div>";
			}

			document.getElementById("contentcontainer").innerHTML = out;
		}
	}

	request.send("{\"id\": \"*\"}");

</script>

@include(bottom.htm)
